!function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=1)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return o(t,null,[{key:"clone",value:function(t){t="object"==(void 0===t?"undefined":r(t))?t:{};return $.extend(!0,{},t)}},{key:"ArrayMergeSameValue",value:function(t){if("object"==(void 0===t?"undefined":r(t))&&t.length&&t.length>1){for(var e={},n=[],o=0;o<t.length;o++)e[t[o]]||(n.push(t[o]),e[t[o]]=!0);t=n}return t}},{key:"each",value:function(t,e){if("object"==(void 0===t?"undefined":r(t)))if($.isArray(t))for(var n=0;n<t.length&&!1!==e(n,t[n]);n++);else for(var o in t)if(!1===e(o,t[o]))break}}]),t}();e.Util=i},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=r(n(2)),u=n(0),c=r(n(7)),f=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$index=c.default.getIndex(),this.Nodes={},this.config=u.Util.clone(e),this.$raphael=c.default.createInstance(this.config),this.$flow=new a.default(this.$raphael),this.setOption(n),this.draw()}return i(t,[{key:"draw",value:function(){var t=this;if(this.option){var e=this.option.nodes;this.codeIndex(e);var n=this.config,r=this.feature("background.female","rgb(190, 113, 82)"),o=this.feature("background.male","rgb(224, 223, 226)");this.createFeatureKey(r,o);for(var i=n.x||parseInt(.4*n.w),a=n.y||10,c=n.cH||50,f=n.dH||30,l={},s=function(e){var n=t.codeIndex(e),r=null;return n&&n.length>0&&u.Util.each(n,function(t,e){if(l[e])return r=l[e].y,!1}),r},p=function(e){var n=t.codeIndex(e),r=n.length,o=0;return u.Util.each(n,function(t,e){l[e]&&(o+=1)}),r-o},y=0;y<e.length;y++){var h,v=e[y],d=v.code,b=v.name||d,g=this.codeIndex(v.code),x=i;if(v.parent&&-1==v.parent.indexOf(",")){var m=this.getNodeByCode(v.parent);m&&m.c&&(x=this.getStandX(m))}if(g&&g.length>1){var w=p(d),k=Math.ceil(g.length/2),P=x-50,M=(P=x+125*(k-w),s(d));M?P=x+125*(k-w):a+=f+c/2,M=M||a,h=this.$flow.operation(P,M,100,c,b),l[d]={y:a}}else a+=f+c/2,h=this.$flow.operation(x,a,100,c,b);h.$step=v,this.drag(h),"F"==v.type?h.c.attr("fill",r):h.c.attr("fill",o),a+=c/2,h&&(this.Nodes[v.code]=h,this.line(h))}}}},{key:"createFeatureKey",value:function(t,e){this.$flow.operation(20,20,20,20,"男").c.attr("fill",e);this.$flow.operation(20,60,20,20,"女").c.attr("fill",t)}},{key:"drag",value:function(t){!function(t,e){var n={};t.c.drag(function(r,o){r+=n.x,o+=n.y,t.move(r,o),e.line&&"arrow"==e.line?t.ToSyncArrow(r,o):t.ToSyncLine(r,o)},function(){var t,e;if("circle"==this.type)t=this.attr("cx"),e=this.attr("cy");else if("rect"==this.type)t=this.attr("x"),e=this.attr("y");else if("path"==this.type){var r=this.attr("path")[0];t=r[1],e=r[2]}n.x=t,n.y=e},function(){})}(t,this.config)}},{key:"line",value:function(t){var e=this,n=u.Util.clone(t.$step);if(n.parent&&(n.parent=n.parent.replace(/\s/g,"")),n.parent){var r,o=this.config,i=function(t,n){var r,i=e.getNodeByCode(t),a=e.getNodeByCode(n);i&&a&&(o.line&&"arrow"==o.line?(r=e.$flow.arrow(i.getStlnP(),a.getEnlnP(),4)).c.attr("fill","rgb(14, 10, 10)"):r=e.$flow.line(i.getStlnP(),a.getEnlnP()),i.recordLine("from",r),a.recordLine("to",r))};r=n.parent.indexOf(",")>-1?n.parent.split(","):[n.parent];for(var a=0;a<r.length;a++)i(r[a],n.code)}}},{key:"setOption",value:function(t){"object"==(void 0===t?"undefined":o(t))&&(this.option=u.Util.clone(t))}},{key:"getNodeByCode",value:function(t){return this.Nodes[t]?this.Nodes[t]:null}},{key:"codeIndex",value:function(t){if("object"==(void 0===t?"undefined":o(t))){for(var e={},n=0;n<t.length;n++){var r=t[n],i=r.code;if(r.parent)for(var a=r.parent.replace(/\s/g,"").split(","),f=0;f<a.length;f++){var l=a[f],s=e[l]?e[l]:0;if("object"==(void 0===s?"undefined":o(s))&&s.length&&(s=1==s.length?s[0]:s),s+=1,e[i]){if("object"!=o(e[i])){var p=e[i];if(2==s&&e[l]){e[l]=p-1;continue}e[i]=[p]}e[i].push(s),e[i]=u.Util.ArrayMergeSameValue(e[i])}else e[i]=s}else e[i]=1}console.log(e),c.default.src(this.$index,"clsMap",e)}else if(t){if(e=c.default.src(this.$index,"clsMap")){var y=e[t]||null,h=[t];for(var v in e)y==e[v]&&-1==$.inArray(v,h)&&h.push(v);return h}}}},{key:"getStandX",value:function(t){var e=null;if(t&&t.c){var n=t.c;switch(n.type){case"circle":e=n.attr("cx");break;case"rect":e=n.attr("x")+n.attr("width")/2;break;case"path":e=t.opt.cx}}return e}},{key:"feature",value:function(t,e){e=e||null;var n=this.option.feature;if(t&&"object"==(void 0===n?"undefined":o(n))){t=t.replace(/\s/g,"").split(".");var r=u.Util.clone(n);u.Util.each(t,function(t,n){if(r&&"object"==(void 0===r?"undefined":o(r)))r=r[n]||e;else if(!r)return r=e,!1}),e=r}return e}}]),t}();e.default=f},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=(n(0),r(n(3))),a=r(n(5)),u=r(n(6)),c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.paper=e}return o(t,[{key:"operation",value:function(t,e,n,r,o){var a=new i.default(this.paper);return a.create(t,e,n,r,o),a}},{key:"line",value:function(t,e){var n=new a.default(this.paper);return n.create(t,e),n}},{key:"arrow",value:function(t,e,n){var r=new u.default(this.paper);return r.create(t,e,n),r}}]),t}();e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(t){return t&&t.__esModule?t:{default:t}}(n(4)),a=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.instance=t,n.opt={},n.bBox=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.default),o(e,[{key:"create",value:function(t){if("object"!=(void 0===t?"undefined":r(t))){var e=arguments;t={cx:e[0],cy:e[1],w:e[2],h:e[3]},e[4]&&(t.text=e[4])}this.opt=t;var n=this.getAp();this.c=this.instance.rect(n.x,n.y,t.w,t.h);var o;o=t.text?this.instance.text(t.cx,t.cy,t.text):this.instance.text(t.cx,t.cy),this.label=o}},{key:"move",value:function(t,e){var n=this.getCtpByAp(t,e);this.c.attr({x:t,y:e}),this.label.attr(n)}},{key:"ToSyncLine",value:function(t,e){var n=this,r=this.getCtpByAp(t,e);this.syncLineMove(function(t,e,o){var i,a=o.position;if("from"==e){var u=t.attr("path");i="get"+a.from+"p";var c=n[i](r.x,r.y);u[0]=["M",c.x,c.y],t.attr("path",u)}else if("to"==e){i="get"+a.to+"p";var f=n[i](r.x,r.y),l=t.attr("path");l[l.length-1]=["L",f.x,f.y],t.attr("path",l)}})}},{key:"ToSyncArrow",value:function(t,e){var n=this,r=this.getCtpByAp(t,e);this.syncLineMove(function(t,e,o){var i,a=o.position;if("from"==e){i="get"+a.from+"p";var u=n[i](r.x,r.y);o.updatePath([u.x,u.y])}else if("to"==e){i="get"+a.to+"p";var c=n[i](r.x,r.y);o.updatePath(null,[c.x,c.y])}})}},{key:"getStlnP",value:function(){var t=this.getBtp();return t.position="Bt",t}},{key:"getEnlnP",value:function(){var t=this.getTp();return t.position="T",t}},{key:"getCtpByAp",value:function(t,e){var n=this.opt;return t+=n.w/2,e+=n.h/2,{x:t,y:e}}},{key:"getAp",value:function(t,e){var n=this.opt;return t=t||n.cx,e=e||n.cy,t-=n.w/2,e-=n.h/2,{x:t,y:e}}},{key:"getBp",value:function(t,e){var n=this.opt;return t=t||n.cx,e=e||n.cy,t-=n.w/2,e+=n.h/2,{x:t,y:e}}},{key:"getCp",value:function(t,e){var n=this.opt;return t=t||n.cx,e=e||n.cy,t+=n.w/2,e+=n.h/2,{x:t,y:e}}},{key:"getDp",value:function(t,e){var n=this.opt;return t=t||n.cx,e=e||n.cy,t-=n.w/2,e+=n.h/2,{x:t,y:e}}},{key:"getTp",value:function(t,e){var n=this.opt;return t=t||n.cx,e=e||n.cy,e-=n.h/2,{x:t,y:e}}},{key:"getRp",value:function(t,e){var n=this.opt;return t=t||n.cx,e=e||n.cy,t+=n.w/2,{x:t,y:e}}},{key:"getBtp",value:function(t,e){var n=this.opt;return t=t||n.cx,e=e||n.cy,e+=n.h/2,{x:t,y:e}}},{key:"getLp",value:function(t,e){var n=this.opt;return t=t||n.cx,e=e||n.cy,t-=n.w/2,e+=n.h/2,{x:t,y:e}}}]),e}();e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.fromLine=[],this.toLine=[]}return r(t,[{key:"recordLine",value:function(t,e){"from"==t?this.fromLine.push(e):"to"==t&&this.toLine.push(e)}},{key:"syncLineMove",value:function(t){"function"!=typeof t&&(t=function(t,e){});for(var e=this.fromLine,n=this.toLine,r=0;r<e.length;r++){var o=e[r].c;o.attr("path");t(o,"from",e[r])}for(var i=0;i<n.length;i++){t(n[i].c,"to",n[i])}}}]),t}();e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(0),i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.instance=e,this.opt={},this.position={},this.rightAngle=!1}return r(t,[{key:"create",value:function(t,e){this.opt={p1:t,p2:e},this.c=this.instance.path("M"+t[0]+","+t[1]+"L"+e[0]+","+e[1])}},{key:"RightAngle",value:function(t){this.opt=t,this.rightAngle=!0;var e=t.p1,n=t.p2,r=20;t.d&&(r=t.d);var o="";if(e.x!=n.x&&e.y!=n.y){var i=n.x-e.x;o="L"+(e.x+i+r*(i>0?1:-1))+","+e.y+"L"+(e.x+i+r*(i>0?1:-1))+","+n.y}this.c=this.instance.path("M"+e.x+","+e.y+o+"L"+n.x+","+n.y)}},{key:"createByPoint",value:function(t){this.opt=t;var e="";o.Util.each(this.opt.points,function(t,n){n&&(e+=(e?"L":"M")+n.x+","+n.y)}),this.c=this.instance.path(e)}}]),t}();e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.instance=e,this.opt={},this.position={}}return r(t,[{key:"create",value:function(t,e,n){this.opt={p1:t,p2:e,r:n};var r=this.getPoints();this.c=this.instance.path("M"+t[0]+","+t[1]+"L"+e[0]+","+e[1]+"L"+r.cP.x+","+r.cP.y+"L"+r.dP.x+","+r.dP.y+"L"+e[0]+","+e[1])}},{key:"getPoints",value:function(t,e,n){var r=this.opt;t||(t=r.p1),e||(e=r.p2),n||(n=r.r);var o=Math.atan2(t[1]-e[1],e[0]-t[0])*(180/Math.PI),i=e[0]-n*Math.cos(o*(Math.PI/180)),a=e[1]+n*Math.sin(o*(Math.PI/180));return{cP:{x:i+n*Math.cos((o+120)*(Math.PI/180)),y:a-n*Math.sin((o+120)*(Math.PI/180))},dP:{x:i+n*Math.cos((o+240)*(Math.PI/180)),y:a-n*Math.sin((o+240)*(Math.PI/180))}}}},{key:"updatePath",value:function(t,e,n){var r=this.opt;t||(t=r.p1),e||(e=r.p2),n||(n=r.r);var o=this.getPoints(t,e,n);this.c.attr("path",[["M",t[0],t[1]],["L",e[0],e[1]],["L",o.cP.x,o.cP.y],["L",o.dP.x,o.dP.y],["L",e[0],e[1]]]),this.opt={p1:t,p2:e,r:n}}}]),t}();e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=0,a={},u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return o(t,null,[{key:"createInstance",value:function(t){return(t="object"==(void 0===t?"undefined":r(t))?t:{}).dom,"string"==typeof t.dom&&(t.dom=$(t.dom)),t.w||(t.w=parseInt(1.1*$(window).width())),t.h||(t.h=parseInt(1.1*$(window).height())),Raphael(t.dom.get(0),t.w,t.h)}},{key:"onMoveEvt",value:function(){}},{key:"onStartEvt",value:function(){}},{key:"onEndEvt",value:function(){}},{key:"getIndex",value:function(){return i+=1}},{key:"src",value:function(t,e,n){a[t]||(a[t]={});var r=a[t];return void 0===e?r:void 0===n?r[e]||null:void(r[e]=n)}}]),t}();e.default=u}]);